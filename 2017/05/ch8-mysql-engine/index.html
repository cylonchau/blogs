<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ch08 - MySQL存储引擎 | Cylon's Collection</title><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NP3JNCPR" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><meta name=keywords content="mysql,non-interact,mysql存储引擎"><meta name=description content="什么是存储引擎 在经清楚什么是存储引擎之前，我们先来个比喻，我们都知道录制一个视频文件，可以转换成不同的格式如mp4 avi wmv等，而存在我们电脑的磁盘上也会存在于不同类型的文件系统中如windows里常见的ntfs fat32，存在于linux常见的ext3 ext4 xfs，但是，给我们或者用户看到实际视频内容都是一样的。直观区别是，占用系统的空间大小与清晰程度可能不一样。
那么数据库表里的数据存储在数据库里及磁盘上和上述的视频格式及存储磁盘文件系统格式特征类似，也有很多中存储方式。
但是，对于用户和应用程序来说同样一张表的数据，无论用什么引擎来存储，用户看到的数据都是一样的。不同的引擎存储，引擎功能，占用的空间大小，读取性能等可能有区别。
MySQL最常用的存储引擎为：MyISAM和InnoDB。全文索引：目前MySQL5.5版本，myisam和inondb都已经支持。
MySQL存储引擎的架构 MySQL的存储引擎是MySQL数据库的重要组成部分，MySQL常用的表的引擎为MyISAM和InnoDB两种。MySQL的每种存储引擎在MySQL里是通过插件的方式使用的，MySQL可以同时支持多种存储引擎。下面是MySQL存储引擎体系结构简图：
MyISAM引擎 MyISAM引擎是MySQL关系数据库管理系统的默认存储引擎（MySQL 5.5.5以前）。这种MySQL表存储结构从旧的ISAM代码扩展出许多有用的功能。在新版本MySQL中，InnoDB引擎由于其对事务参照完整性，以及更高的并发性等优点开始逐步的取代MyISAM引擎，
“InnoDB is the default storage engine as of MySQL 5.5.5。MyISAM: The MySQL storage engine that is used the most in Web,data warehousing,and other application environments.MyISAM is supported in all MySQL configurations,an is the default storage engine prior to MySQL 5.5.5。”
查看MySQL5.1数据库默认引擎
bash 1 2 3 4 5 6 7 mysql> show create table test1\G *************************** 1."><meta name=author content="cylon"><link rel=canonical href=https://www.oomkill.com/2017/05/ch8-mysql-engine/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://www.oomkill.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.oomkill.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.oomkill.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.oomkill.com/favicon.ico><link rel=mask-icon href=https://www.oomkill.com/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://www.oomkill.com/2017/05/ch8-mysql-engine/><noscript><style>#theme-toggle,#top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link crossorigin=anonymous href=/assets/css/pe.min.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/pe.min.js></script><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/all.min.css><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/v4-shims.min.css><script defer src=https://cdn.staticfile.net/jquery/3.5.1/jquery.min.js></script><link rel=stylesheet href=https://cdn.staticfile.net/fancybox/3.5.7/jquery.fancybox.min.css><script defer src=https://cdn.staticfile.net/fancybox/3.5.7/jquery.fancybox.min.js></script><script id=MathJax-script async src=https://cdn.staticfile.net/mathjax/3.2.2/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["$$","$$"]],inlineMath:[["\\$","\\$"]]}}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-H94HZ5S19Y"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-H94HZ5S19Y")</script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><meta property="og:title" content="ch08 - MySQL存储引擎"><meta property="og:description" content="什么是存储引擎 在经清楚什么是存储引擎之前，我们先来个比喻，我们都知道录制一个视频文件，可以转换成不同的格式如mp4 avi wmv等，而存在我们电脑的磁盘上也会存在于不同类型的文件系统中如windows里常见的ntfs fat32，存在于linux常见的ext3 ext4 xfs，但是，给我们或者用户看到实际视频内容都是一样的。直观区别是，占用系统的空间大小与清晰程度可能不一样。
那么数据库表里的数据存储在数据库里及磁盘上和上述的视频格式及存储磁盘文件系统格式特征类似，也有很多中存储方式。
但是，对于用户和应用程序来说同样一张表的数据，无论用什么引擎来存储，用户看到的数据都是一样的。不同的引擎存储，引擎功能，占用的空间大小，读取性能等可能有区别。
MySQL最常用的存储引擎为：MyISAM和InnoDB。全文索引：目前MySQL5.5版本，myisam和inondb都已经支持。
MySQL存储引擎的架构 MySQL的存储引擎是MySQL数据库的重要组成部分，MySQL常用的表的引擎为MyISAM和InnoDB两种。MySQL的每种存储引擎在MySQL里是通过插件的方式使用的，MySQL可以同时支持多种存储引擎。下面是MySQL存储引擎体系结构简图：
MyISAM引擎 MyISAM引擎是MySQL关系数据库管理系统的默认存储引擎（MySQL 5.5.5以前）。这种MySQL表存储结构从旧的ISAM代码扩展出许多有用的功能。在新版本MySQL中，InnoDB引擎由于其对事务参照完整性，以及更高的并发性等优点开始逐步的取代MyISAM引擎，
“InnoDB is the default storage engine as of MySQL 5.5.5。MyISAM: The MySQL storage engine that is used the most in Web,data warehousing,and other application environments.MyISAM is supported in all MySQL configurations,an is the default storage engine prior to MySQL 5.5.5。”
查看MySQL5.1数据库默认引擎
bash 1 2 3 4 5 6 7 mysql> show create table test1\G *************************** 1."><meta property="og:type" content="article"><meta property="og:url" content="https://www.oomkill.com/2017/05/ch8-mysql-engine/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-05-23T00:00:00+00:00"><meta property="article:modified_time" content="2022-12-14T23:00:36+08:00"><meta property="og:site_name" content="Cylon's Collection"><meta name=twitter:card content="summary"><meta name=twitter:title content="ch08 - MySQL存储引擎"><meta name=twitter:description content="什么是存储引擎 在经清楚什么是存储引擎之前，我们先来个比喻，我们都知道录制一个视频文件，可以转换成不同的格式如mp4 avi wmv等，而存在我们电脑的磁盘上也会存在于不同类型的文件系统中如windows里常见的ntfs fat32，存在于linux常见的ext3 ext4 xfs，但是，给我们或者用户看到实际视频内容都是一样的。直观区别是，占用系统的空间大小与清晰程度可能不一样。
那么数据库表里的数据存储在数据库里及磁盘上和上述的视频格式及存储磁盘文件系统格式特征类似，也有很多中存储方式。
但是，对于用户和应用程序来说同样一张表的数据，无论用什么引擎来存储，用户看到的数据都是一样的。不同的引擎存储，引擎功能，占用的空间大小，读取性能等可能有区别。
MySQL最常用的存储引擎为：MyISAM和InnoDB。全文索引：目前MySQL5.5版本，myisam和inondb都已经支持。
MySQL存储引擎的架构 MySQL的存储引擎是MySQL数据库的重要组成部分，MySQL常用的表的引擎为MyISAM和InnoDB两种。MySQL的每种存储引擎在MySQL里是通过插件的方式使用的，MySQL可以同时支持多种存储引擎。下面是MySQL存储引擎体系结构简图：
MyISAM引擎 MyISAM引擎是MySQL关系数据库管理系统的默认存储引擎（MySQL 5.5.5以前）。这种MySQL表存储结构从旧的ISAM代码扩展出许多有用的功能。在新版本MySQL中，InnoDB引擎由于其对事务参照完整性，以及更高的并发性等优点开始逐步的取代MyISAM引擎，
“InnoDB is the default storage engine as of MySQL 5.5.5。MyISAM: The MySQL storage engine that is used the most in Web,data warehousing,and other application environments.MyISAM is supported in all MySQL configurations,an is the default storage engine prior to MySQL 5.5.5。”
查看MySQL5.1数据库默认引擎
bash 1 2 3 4 5 6 7 mysql> show create table test1\G *************************** 1."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.oomkill.com/posts/"},{"@type":"ListItem","position":2,"name":"ch08 - MySQL存储引擎","item":"https://www.oomkill.com/2017/05/ch8-mysql-engine/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ch08 - MySQL存储引擎","name":"ch08 - MySQL存储引擎","description":"什么是存储引擎 在经清楚什么是存储引擎之前，我们先来个比喻，我们都知道录制一个视频文件，可以转换成不同的格式如mp4 avi wmv等，而存在我们电脑的磁盘上也会存在于不同类型的文件系统中如windows里常见的ntfs fat32，存在于linux常见的ext3 ext4 xfs，但是，给我们或者用户看到实际视频内容都是一样的。直观区别是，占用系统的空间大小与清晰程度可能不一样。\n那么数据库表里的数据存储在数据库里及磁盘上和上述的视频格式及存储磁盘文件系统格式特征类似，也有很多中存储方式。\n但是，对于用户和应用程序来说同样一张表的数据，无论用什么引擎来存储，用户看到的数据都是一样的。不同的引擎存储，引擎功能，占用的空间大小，读取性能等可能有区别。\nMySQL最常用的存储引擎为：MyISAM和InnoDB。全文索引：目前MySQL5.5版本，myisam和inondb都已经支持。\nMySQL存储引擎的架构 MySQL的存储引擎是MySQL数据库的重要组成部分，MySQL常用的表的引擎为MyISAM和InnoDB两种。MySQL的每种存储引擎在MySQL里是通过插件的方式使用的，MySQL可以同时支持多种存储引擎。下面是MySQL存储引擎体系结构简图：\nMyISAM引擎 MyISAM引擎是MySQL关系数据库管理系统的默认存储引擎（MySQL 5.5.5以前）。这种MySQL表存储结构从旧的ISAM代码扩展出许多有用的功能。在新版本MySQL中，InnoDB引擎由于其对事务参照完整性，以及更高的并发性等优点开始逐步的取代MyISAM引擎，\n“InnoDB is the default storage engine as of MySQL 5.5.5。MyISAM: The MySQL storage engine that is used the most in Web,data warehousing,and other application environments.MyISAM is supported in all MySQL configurations,an is the default storage engine prior to MySQL 5.5.5。”\n查看MySQL5.1数据库默认引擎\nbash 1 2 3 4 5 6 7 mysql\u0026gt; show create table test1\\G *************************** 1.","keywords":["mysql","non-interact","mysql存储引擎"],"articleBody":"什么是存储引擎 在经清楚什么是存储引擎之前，我们先来个比喻，我们都知道录制一个视频文件，可以转换成不同的格式如mp4 avi wmv等，而存在我们电脑的磁盘上也会存在于不同类型的文件系统中如windows里常见的ntfs fat32，存在于linux常见的ext3 ext4 xfs，但是，给我们或者用户看到实际视频内容都是一样的。直观区别是，占用系统的空间大小与清晰程度可能不一样。\n那么数据库表里的数据存储在数据库里及磁盘上和上述的视频格式及存储磁盘文件系统格式特征类似，也有很多中存储方式。\n但是，对于用户和应用程序来说同样一张表的数据，无论用什么引擎来存储，用户看到的数据都是一样的。不同的引擎存储，引擎功能，占用的空间大小，读取性能等可能有区别。\nMySQL最常用的存储引擎为：MyISAM和InnoDB。全文索引：目前MySQL5.5版本，myisam和inondb都已经支持。\nMySQL存储引擎的架构 MySQL的存储引擎是MySQL数据库的重要组成部分，MySQL常用的表的引擎为MyISAM和InnoDB两种。MySQL的每种存储引擎在MySQL里是通过插件的方式使用的，MySQL可以同时支持多种存储引擎。下面是MySQL存储引擎体系结构简图：\nMyISAM引擎 MyISAM引擎是MySQL关系数据库管理系统的默认存储引擎（MySQL 5.5.5以前）。这种MySQL表存储结构从旧的ISAM代码扩展出许多有用的功能。在新版本MySQL中，InnoDB引擎由于其对事务参照完整性，以及更高的并发性等优点开始逐步的取代MyISAM引擎，\n“InnoDB is the default storage engine as of MySQL 5.5.5。MyISAM: The MySQL storage engine that is used the most in Web,data warehousing,and other application environments.MyISAM is supported in all MySQL configurations,an is the default storage engine prior to MySQL 5.5.5。”\n查看MySQL5.1数据库默认引擎\nbash 1 2 3 4 5 6 7 mysql\u003e show create table test1\\G *************************** 1. row *************************** Table: test1 Create Table: CREATE TABLE `test1` ( `name` int(11) DEFAULT NULL ) ENGINE=MyISAM DEFAULT CHARSET=latin1 1 row in set (0.00 sec) 提示：MySQL 5.1数据库的默认存储引擎为MyISAM。\n每一个MyISAM的表都对应于硬盘上的三个文件。这三个文件有一样的文件名，但是有不同的扩展名指示其类型用途：\n.frm文件保存表的定义，这个文件并不是MyISAM引擎的一部分，而是服务器的一部分\n.MYD保存表的数据\n.MYI是表的索引文件。\n# MYD和MYI是MyISAM的关键点\n范例\nbash 1 2 3 4 $ ll /var/lib/mysql/mysql/ user.frm\t# 表的定义 user.MYD\t# data user.MYI\t# index MySQL系统的表多数属于MyISAM引擎\nbash 1 2 3 4 $ ls /var/lib/mysql/mysql/ columns_priv.frm help_keyword.frm proc.frm time_zone_leap_second.MYI columns_priv.MYD help_keyword.MYD proc.MYD time_zone.MYD columns_priv.MYI help_keyword.MYI proc.MYI time_zone.MYI “为什么MySQL5.5.5以前默认的是MyISAM引擎，而MySQL5.5.5以后默认是innodb”\n答：和互联网发展有关，互联网诞生之初。基本上已读为主，那时机器硬件性能低。设计数据库时需要占用资源少的数据库。5.5之后选择了innodb\n“为什么mysql库里内部表默认是myisam”\nweb2.0时代：以用户为中心的时代多数平台都是用户上传其他用户读）在这种时代myisam引擎就胜任不了了，顾mysql5。\nMyISAM引擎特点 至少掌握5点\n不支持事务 事务是指逻辑上的一组操作，组成这组操作的各个单元，要么全成功要么全失败\n表级锁定 数据更新时锁定整个表：其锁定机制是表级锁定，这虽然可以让锁定的实现成本很小但是也同时降低了其开发性能\n举例子：上厕所，还有很多小便坑，锁上外面的们，一个人上厕所，谁也去不了厕所了。\n表级锁定并发处理降低，但是提升了效率 举例：商场有小偷，不知道在哪，锁住一楼大门，然后逐一摸排\n缺点是，别人想出出不去了。但是对于保安来说是最有效的方法。\n读写互相阻塞 不仅会在写入的时候阻塞读取，myisam还会在读取的时候阻塞写入，但读本身并不会阻塞另外的读\n只会缓存索引 MyISAM可以通过key_buffer_size（只是myisam）缓存索引，以大大提高访问性能较少磁盘IO，但这个缓存区只会缓存索引，而不会缓存数据\n读取速度较快。占用资源相对少。\n不支持外键约束，但支持全文索引。\nMyISAM引擎是MySQL5.5.5 前默认的存储引擎 ( “is the default storage engine prior to MySQL 5.5.5” )。\nMyISAM引擎适用的生产业务场景 不需要事务支持的业务（例如转账就不行）。 一般为读数据比较多的应用，读写都频繁场景不适合，读多或者写多的都适合。 读写并发相对较低的业务（纯读纯写高并发也可以）（锁机制问题）。 数据修改相对少的业务（阻塞问题）。 已读为主的业务，例如：读数据库系统表、www blog 图片信息数据库 用户数据库 商品库等业务。 对数据一致性要求不是非常高的业务（MySQL 5.6前不支持事务）。 硬件资源比较差的机器都可以用myisam（占用资源少）。 使用读写分离的MySQL从库可以使用myisam（5年前提到较多） 小结：单一对数据库的操作都可以使用myisam，所谓单一就是尽量纯读，或纯写（insert update delete）等\nInnoDB引擎 Innodb引擎是MySQL数据库的另一个重要的存储引擎，正式成为MySQLAB所发行新版的标准，被包含在所有二进制安装包里。和其他的存储引擎相比，InnoDB引擎的优势是支持兼容ACID的事务（类似于PostgreSQL），以及参数完整性（即对外键的支持）。Oracle公司2005年手抽了Innobase。innobase采用双认证授权。它使用GNU发型，也允许其他想将InnoDB结合到商业软件的团体获得授权。\n更多参考 reman-5.5-en.html-chapter/storage-engines.html\n提示：只有test1.frm没有MyISAM对应的数据文件和索引文件了。\nbash 1 2 3 4 5 6 7 $ ll test/ ibdata1 ib_logfile0 # ib_logfile1\t# 这里是存放Innodb数据文件 ib_logfile2 # test1.frm\ttest2.frm InnoDB引擎特点 支持事务：支持4个事务隔离级别，支持多版本读。 行级锁定（更新时一般是锁定当前行）：通过索引实现，全表扫描仍然会是表锁，注意间隙锁的影响。 读写阻塞与事务隔离级别相关。 具有非常搞笑的缓存特性：能缓存索引，也能缓存数据。 整个表和主键以Cluster方式存储，组成一颗平衡树。 所有Secondary Index都会保存主键信息。 支持分区，表空间，类似oracle数据库 支持外键约束，5.5前不支持全文索引 和MyISAM引擎比，InnoDB对硬件资源要求更高 面试必问\ninnodb特点：面试必答项：\nrow-level locking full-text search indexs data caches index caches transactions 占用资源多 读写阻塞与事务隔离级别相关 外键 innodb引擎使用的生产业务场景 需要事务支持的业务（具有较好的事务特性）。 行级锁定对高并发有很好的适应能力，但需要确保查询是通过索引完成。 数据读写及更新都较为频繁的场景，如:BBS SNS 微博，微信等。 数据一致性要求较高的业务，例如：充值转账，银行卡转账。 硬件设备内存较大，可以利用InnoDB较好的缓存能力来提高内存利用率，尽可能减少磁盘IO conf innodb_additional_mem_pool_size = 4M innodb_buffer_pool_size = 32M innodb_data_file_path = ibdata1:128M:autoextend innodb_file_io_threads = 4 innodb_thread_concurrency = 8 innodb_flush_log_at_trx_commit = 2 innodb_log_buffer_size = 2M innodb_log_file_size = 4M innodb_log_files_in_group = 3 innodb_max_dirty_pages_pct = 90 innodb_lock_wait_timeout = 120 innodb_file_per_table = 0 共享表空间对应物理数据文件\nbash 1 2 3 $ ll test/ ibdata1 ib_logfile0 独立表空间对应物理数据文件\nbash 1 2 innodb_file_per_table innodb_data_home_dir=xxx innodb引擎调优精要 主键尽可能小，避免给Secondary index带来过大的空间负担\n建立有效索引避免全表扫描，因为会使用表锁。\n尽可能缓存所有的索引和数据，提高相应速度，减少磁盘IO消耗\n在大批量小插入的时候，尽量自己控制事务而不要使用autocommit自动提交。有开关可以控制提交方式；\n合理设置innodb_flush_log_at_trx_commit参数值，不要过度追求安全性。\n如果innodb_flush_log_at_trx_commit的值为0，log buffer每秒就会被刷写日志文件到磁盘，提交事务时候不做任何操作。\n避免主键更新。（字段的起名长短都会影响性能）。\nMySQL引擎特别说明 Feature MyISAM Memory InnoDB Archive NDB Storage limits 256TB RAM 64TB None 384EB Transactions No No Yes No Yes Locking granularity Table Table Row Row Row MVCC No No Yes No No Geospatial data type support Yes No Yes Yes Yes Geospatial indexing support Yes No Yes[a] No No B-tree indexes Yes Yes Yes No No T-tree indexes No No No No Yes Hash indexes No Yes No[b] No Yes Full-text search indexes Yes No Yes[c] No No Clustered indexes No No Yes No No Data caches No N/A Yes No Yes Index caches Yes N/A Yes No Yes Compressed data Yes[d] No Yes[e] Yes No Encrypted data[f] Yes Yes Yes Yes Yes Cluster database support No No No No Yes Replication support[g] Yes Yes Yes Yes Yes Foreign key support No No Yes No No Backup / point-in-time recovery[h] Yes Yes Yes Yes Yes Query cache support Yes Yes Yes Yes Yes Update statistics for data dictionary Yes Yes Yes Yes Yes [a] InnoDB support for geospatial indexing is available in MySQL 5.7.5 and higher. [b] InnoDB utilizes hash indexes internally for its Adaptive Hash Index feature. [c] InnoDB support for FULLTEXT indexes is available in MySQL 5.6.4 and higher. [d] Compressed MyISAM tables are supported only when using the compressed row format. Tables using the compressed row format with MyISAM are read only. [e] Compressed InnoDB tables require the InnoDB Barracuda file format. [f] Implemented in the server (via encryption functions). Data-at-rest tablespace encryption is available in MySQL 5.7 and higher. [g] Implemented in the server, rather than in the storage engine. [h] Implemented in the server, rather than in the storage engine. 参考手册：https://dev.mysql.com/doc/refman/5.5/en/storage-engines.html\n以上是myisam innodb和NDBCluster三个存储引擎是目前互联网公司应用比较多的存储引擎，特别是前两者，其他如 memory merge csv archive等存储引擎的使用场景都相对较少，初学的同学可以暂时忽略。更多可参考MySQL官方文档。\n如何确定MySQL服务器有那些引擎可用？ 在MySQL中使用显示引擎的命令得到一个可用引擎的列表\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 show engines\\G ... ... *************************** 5. row *************************** Engine: MyISAM Support: YES Comment: MyISAM storage engine Transactions: NO XA: NO Savepoints: NO *************************** 6. row *************************** Engine: InnoDB Support: DEFAULT Comment: Percona-XtraDB, Supports transactions, row-level locking, and foreign keys Transactions: YES XA: YES Savepoints: YES ... ... 10 rows in set (0.01 sec) 生产场景中批量更改MySQL引擎 一般来说这样的需求不多见，但偶尔也会有，在这里我们推荐使用sed对备份内容进行引擎转换的方式，当然，不要忘记修改my.cnf使之支持并能高效的使用对应的引擎\n方法1：MySQL命令语句修改\nbash 1 alter table test engine=innodb; 方法2：使用sed对备份内容进行引擎转换\nbash 1 2 3 # 此方法折腾数据不推荐使用 # 主从复制丛库换引擎，正式数据换不要用 sed -e 's#MyISAM#InnoDB#g' b.sql\u003eb1.sql 方法3：mysql_convert_table_format命令修改\nbash 1 mysql_convert_table_format --host=$HOST --user=$USER --passsword=$PASS --socket=$SOCKET --type=$Engine $DB $TN 建表语句加上指定引擎：\nbash 1 2 3 create table test( id int not null ) engine=innodb default charset=utf8; 混合引擎和单独innodb引擎配置差别？\n有关MySQL引擎常见企业面试题 MySQL有那些存储引擎，各自有什么特点和区别？ 生产环境中如何选用MySQL的引擎 ​\t在一般的既有读又有写的业务中，建议使用innodb引擎，一句话尽可能多的使用innodb引擎。\n​\t纯读 纯写可用myisam。例如系统的MySQL库。\n不同引擎如何备份？混合引擎如何备份。\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # myisam mysqldump -uroot -p111 -S/data/3306/mysql.sock \\ -A \\ -x \\ -B \\ -F \\ --master-data=2|gzip \u003eback.sql # innodb mysqldump -uroot -p111 -S/data/3306/mysql.sock \\ -A \\ -x \\ -B \\ -F \\ --master-data=2 \\ --single-transaction|gzip \u003eback.sql ","wordCount":"786","inLanguage":"zh","datePublished":"2017-05-23T00:00:00Z","dateModified":"2022-12-14T23:00:36+08:00","author":{"@type":"Person","name":"cylon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.oomkill.com/2017/05/ch8-mysql-engine/"},"publisher":{"@type":"Organization","name":"Cylon's Collection","logo":{"@type":"ImageObject","url":"https://www.oomkill.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.oomkill.com/><img src=https://www.oomkill.com/favicon.ico alt aria-label=logo height=20>Cylon's Collection</a><div class=logo-switches><button id=theme-toggle><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.oomkill.com/archives><span>归档</span></a></li><li><a href=https://www.oomkill.com/tags><span>标签</span></a></li><li><a href=https://www.oomkill.com/search><span>搜索</span></a></li><li><a href=https://www.oomkill.com/about accesskey=/><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">ch08 - MySQL存储引擎</h1><div class=post-meta><span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>2017-05-23</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg><span>786 字</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>4 分钟</span></span>
<span class=pe-post-meta-item>&nbsp;·&nbsp;<svg t="1714036239378" fill="currentcolor" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="6659" width="256" height="256"><path d="M690 78.2c-18.6-18.8-49-19-67.8-.4s-19 49-.4 67.8l255.4 258.6c67.8 68.6 67.8 178.8.0 247.4L653.4 878.2c-18.6 18.8-18.4 49.2.4 67.8s49.2 18.4 67.8-.4l224-226.4c104.8-106 104.8-276.4.0-382.4L690 78.2zM485.4 101.4c-24-24-56.6-37.4-90.6-37.4H96C43 64 0 107 0 160v299c0 34 13.4 66.6 37.4 90.6l336 336c50 50 131 50 181 0l267-267c50-50 50-131 0-181l-336-336zM96 160h299c8.4.0 16.6 3.4 22.6 9.4l336 336c12.4 12.4 12.4 32.8.0 45.2l-267 267c-12.4 12.4-32.8 12.4-45.2.0l-336-336c-6-6-9.4-14.2-9.4-22.6V160zm192 128a64 64 0 10-128 0 64 64 0 10128 0z" p-id="6660"/></svg></span><ul class=pe-post-meta-item><a href=https://www.oomkill.com/tags/databases/>#Databases</a></ul></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details><summary><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e4%bb%80%e4%b9%88%e6%98%af%e5%ad%98%e5%82%a8%e5%bc%95%e6%93%8e aria-label=什么是存储引擎>什么是存储引擎</a><li><a href=#mysql%e5%ad%98%e5%82%a8%e5%bc%95%e6%93%8e%e7%9a%84%e6%9e%b6%e6%9e%84 aria-label=MySQL存储引擎的架构>MySQL存储引擎的架构</a><li><a href=#myisam%e5%bc%95%e6%93%8e aria-label=MyISAM引擎>MyISAM引擎</a><ul><li><a href=#myisam%e5%bc%95%e6%93%8e%e7%89%b9%e7%82%b9 aria-label=MyISAM引擎特点>MyISAM引擎特点</a><li><a href=#myisam%e5%bc%95%e6%93%8e%e9%80%82%e7%94%a8%e7%9a%84%e7%94%9f%e4%ba%a7%e4%b8%9a%e5%8a%a1%e5%9c%ba%e6%99%af aria-label=MyISAM引擎适用的生产业务场景>MyISAM引擎适用的生产业务场景</a></ul><li><a href=#innodb%e5%bc%95%e6%93%8e aria-label=InnoDB引擎>InnoDB引擎</a><ul><li><a href=#innodb%e5%bc%95%e6%93%8e%e7%89%b9%e7%82%b9 aria-label=InnoDB引擎特点>InnoDB引擎特点</a><li><a href=#innodb%e5%bc%95%e6%93%8e%e4%bd%bf%e7%94%a8%e7%9a%84%e7%94%9f%e4%ba%a7%e4%b8%9a%e5%8a%a1%e5%9c%ba%e6%99%af aria-label=innodb引擎使用的生产业务场景>innodb引擎使用的生产业务场景</a><li><a href=#innodb%e5%bc%95%e6%93%8e%e8%b0%83%e4%bc%98%e7%b2%be%e8%a6%81 aria-label=innodb引擎调优精要>innodb引擎调优精要</a></ul><li><a href=#mysql%e5%bc%95%e6%93%8e%e7%89%b9%e5%88%ab%e8%af%b4%e6%98%8e aria-label=MySQL引擎特别说明>MySQL引擎特别说明</a><li><a href=#%e5%a6%82%e4%bd%95%e7%a1%ae%e5%ae%9amysql%e6%9c%8d%e5%8a%a1%e5%99%a8%e6%9c%89%e9%82%a3%e4%ba%9b%e5%bc%95%e6%93%8e%e5%8f%af%e7%94%a8 aria-label=如何确定MySQL服务器有那些引擎可用？>如何确定MySQL服务器有那些引擎可用？</a><li><a href=#%e7%94%9f%e4%ba%a7%e5%9c%ba%e6%99%af%e4%b8%ad%e6%89%b9%e9%87%8f%e6%9b%b4%e6%94%b9mysql%e5%bc%95%e6%93%8e aria-label=生产场景中批量更改MySQL引擎>生产场景中批量更改MySQL引擎</a><li><a href=#%e6%9c%89%e5%85%b3mysql%e5%bc%95%e6%93%8e%e5%b8%b8%e8%a7%81%e4%bc%81%e4%b8%9a%e9%9d%a2%e8%af%95%e9%a2%98 aria-label=有关MySQL引擎常见企业面试题>有关MySQL引擎常见企业面试题</a></li></div></details></div></aside><script src=/js/pe-toc.min.445eb1bfc5e85dd13b9519fcc2a806522e9629b6224a2974052789ba00ab78af.js integrity="sha256-RF6xv8XoXdE7lRn8wqgGUi6WKbYiSil0BSeJugCreK8="></script><div class=post-content><h2 id=什么是存储引擎>什么是存储引擎<a hidden class=anchor aria-hidden=true href=#什么是存储引擎>#</a></h2><p>在经清楚什么是存储引擎之前，我们先来个比喻，我们都知道录制一个视频文件，可以转换成不同的格式如mp4 avi wmv等，而存在我们电脑的磁盘上也会存在于不同类型的文件系统中如windows里常见的ntfs fat32，存在于linux常见的ext3 ext4 xfs，但是，给我们或者用户看到实际视频内容都是一样的。直观区别是，占用系统的空间大小与清晰程度可能不一样。</p><p>那么数据库表里的数据存储在数据库里及磁盘上和上述的视频格式及存储磁盘文件系统格式特征类似，也有很多中存储方式。</p><p>但是，对于用户和应用程序来说同样一张表的数据，无论用什么引擎来存储，用户看到的数据都是一样的。不同的引擎存储，引擎功能，占用的空间大小，读取性能等可能有区别。</p><p>MySQL最常用的存储引擎为：MyISAM和InnoDB。全文索引：目前MySQL5.5版本，myisam和inondb都已经支持。</p><h2 id=mysql存储引擎的架构>MySQL存储引擎的架构<a hidden class=anchor aria-hidden=true href=#mysql存储引擎的架构>#</a></h2><p>MySQL的存储引擎是MySQL数据库的重要组成部分，MySQL常用的表的引擎为MyISAM和InnoDB两种。MySQL的每种存储引擎在MySQL里是通过插件的方式使用的，MySQL可以同时支持多种存储引擎。下面是MySQL存储引擎体系结构简图：</p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/image-20221214201434104.png><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/image-20221214201434104.png#center alt=image-20221214201434104 onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/image-20221214201452181.png><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/image-20221214201452181.png#center alt=image-20221214201452181 onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><h2 id=myisam引擎>MyISAM引擎<a hidden class=anchor aria-hidden=true href=#myisam引擎>#</a></h2><p>MyISAM引擎是MySQL关系数据库管理系统的默认存储引擎（MySQL 5.5.5以前）。这种MySQL表存储结构从旧的ISAM代码扩展出许多有用的功能。在新版本MySQL中，InnoDB引擎由于其对事务参照完整性，以及更高的并发性等优点开始逐步的取代MyISAM引擎，</p><blockquote><p>“InnoDB is the default storage engine as of MySQL 5.5.5。MyISAM: The MySQL storage engine that is used the most in Web,data warehousing,and other application environments.MyISAM is supported in all MySQL configurations,an is the default storage engine prior to MySQL 5.5.5。”</p></blockquote><p>查看MySQL5.1数据库默认引擎</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mysql&gt; show create table test1<span class=se>\G</span>
</span></span><span class=line><span class=cl>*************************** 1. row ***************************
</span></span><span class=line><span class=cl>       Table: test1
</span></span><span class=line><span class=cl>Create Table: CREATE TABLE <span class=sb>`</span>test1<span class=sb>`</span> <span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=sb>`</span>name<span class=sb>`</span> int<span class=o>(</span>11<span class=o>)</span> DEFAULT NULL
</span></span><span class=line><span class=cl><span class=o>)</span> <span class=nv>ENGINE</span><span class=o>=</span>MyISAM DEFAULT <span class=nv>CHARSET</span><span class=o>=</span>latin1
</span></span><span class=line><span class=cl><span class=m>1</span> row in <span class=nb>set</span> <span class=o>(</span>0.00 sec<span class=o>)</span></span></span></code></pre></td></tr></table></div></div></div></div><p>提示：MySQL 5.1数据库的默认存储引擎为MyISAM。</p><p>每一个MyISAM的表都对应于硬盘上的三个文件。这三个文件有一样的文件名，但是有不同的扩展名指示其类型用途：</p><hr><p>.frm文件保存表的定义，这个文件并不是MyISAM引擎的一部分，而是服务器的一部分</p><p>.MYD保存表的数据</p><p>.MYI是表的索引文件。</p><p># MYD和MYI是MyISAM的关键点</p><hr><p>范例</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ll /var/lib/mysql/mysql/
</span></span><span class=line><span class=cl>user.frm	<span class=c1># 表的定义</span>
</span></span><span class=line><span class=cl>user.MYD	<span class=c1># data</span>
</span></span><span class=line><span class=cl>user.MYI	<span class=c1># index</span></span></span></code></pre></td></tr></table></div></div></div></div><p>MySQL系统的表多数属于MyISAM引擎</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ls /var/lib/mysql/mysql/
</span></span><span class=line><span class=cl>columns_priv.frm   help_keyword.frm      proc.frm                   time_zone_leap_second.MYI
</span></span><span class=line><span class=cl>columns_priv.MYD   help_keyword.MYD      proc.MYD                   time_zone.MYD
</span></span><span class=line><span class=cl>columns_priv.MYI   help_keyword.MYI      proc.MYI                   time_zone.MYI</span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p>“<strong>为什么MySQL5.5.5以前默认的是MyISAM引擎，而MySQL5.5.5以后默认是innodb</strong>”</p><p>答：和互联网发展有关，互联网诞生之初。基本上已读为主，那时机器硬件性能低。设计数据库时需要占用资源少的数据库。5.5之后选择了innodb</p><p>“<strong>为什么mysql库里内部表默认是myisam</strong>”</p><p>web2.0时代：以用户为中心的时代多数平台都是用户上传其他用户读）在这种时代myisam引擎就胜任不了了，顾mysql5。</p></blockquote><h3 id=myisam引擎特点>MyISAM引擎特点<a hidden class=anchor aria-hidden=true href=#myisam引擎特点>#</a></h3><p><strong><font color=#0215cd size=3>至少掌握5点</font></strong></p><ol><li><p><strong>不支持事务</strong> 事务是指逻辑上的一组操作，组成这组操作的各个单元，要么全成功要么全失败</p></li><li><p><strong>表级锁定</strong> 数据更新时锁定整个表：其锁定机制是表级锁定，这虽然可以让锁定的实现成本很小但是也同时降低了其开发性能</p><hr><p>举例子：上厕所，还有很多小便坑，锁上外面的们，一个人上厕所，谁也去不了厕所了。</p><p>表级锁定并发处理降低，但是提升了效率 举例：商场有小偷，不知道在哪，锁住一楼大门，然后逐一摸排</p><p>缺点是，别人想出出不去了。但是对于保安来说是最有效的方法。</p><hr><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/image-20221214201921894.png><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/image-20221214201921894.png#center alt=image-20221214201921894 onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p></li><li><p><strong>读写互相阻塞</strong> 不仅会在写入的时候阻塞读取，myisam还会在读取的时候阻塞写入，但读本身并不会阻塞另外的读</p></li><li><p><strong>只会缓存索引</strong> MyISAM可以通过key_buffer_size（只是myisam）缓存索引，以大大提高访问性能较少磁盘IO，但这个缓存区只会缓存索引，而不会缓存数据</p></li><li><p>读取速度较快。占用资源相对少。</p></li><li><p>不支持外键约束，但支持全文索引。</p></li><li><p>MyISAM引擎是MySQL5.5.5 前默认的存储引擎 ( “is the default storage engine prior to MySQL 5.5.5” )。</p></li></ol><h3 id=myisam引擎适用的生产业务场景>MyISAM引擎适用的生产业务场景<a hidden class=anchor aria-hidden=true href=#myisam引擎适用的生产业务场景>#</a></h3><ol><li>不需要事务支持的业务（例如转账就不行）。</li><li>一般为读数据比较多的应用，读写都频繁场景不适合，读多或者写多的都适合。</li><li>读写并发相对较低的业务（纯读纯写高并发也可以）（锁机制问题）。</li><li>数据修改相对少的业务（阻塞问题）。</li><li>已读为主的业务，例如：读数据库系统表、www blog 图片信息数据库 用户数据库 商品库等业务。</li><li>对数据一致性要求不是非常高的业务（MySQL 5.6前不支持事务）。</li><li>硬件资源比较差的机器都可以用myisam（占用资源少）。</li><li>使用读写分离的MySQL从库可以使用myisam（5年前提到较多）</li></ol><p>小结：单一对数据库的操作都可以使用myisam，所谓单一就是尽量纯读，或纯写（insert update delete）等</p><h2 id=innodb引擎>InnoDB引擎<a hidden class=anchor aria-hidden=true href=#innodb引擎>#</a></h2><p>Innodb引擎是MySQL数据库的另一个重要的存储引擎，正式成为MySQLAB所发行新版的标准，被包含在所有二进制安装包里。和其他的存储引擎相比，InnoDB引擎的优势是支持兼容ACID的事务（类似于PostgreSQL），以及参数完整性（即对外键的支持）。Oracle公司2005年手抽了Innobase。innobase采用双认证授权。它使用GNU发型，也允许其他想将InnoDB结合到商业软件的团体获得授权。</p><p>更多参考 reman-5.5-en.html-chapter/storage-engines.html</p><hr><p>提示：只有test1.frm没有MyISAM对应的数据文件和索引文件了。</p><hr><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ll test/
</span></span><span class=line><span class=cl>ibdata1
</span></span><span class=line><span class=cl>ib_logfile0 <span class=c1>#</span>
</span></span><span class=line><span class=cl>ib_logfile1	<span class=c1># 这里是存放Innodb数据文件</span>
</span></span><span class=line><span class=cl>ib_logfile2 <span class=c1>#</span>
</span></span><span class=line><span class=cl>test1.frm	
</span></span><span class=line><span class=cl>test2.frm</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=innodb引擎特点>InnoDB引擎特点<a hidden class=anchor aria-hidden=true href=#innodb引擎特点>#</a></h3><ol><li>支持事务：支持4个事务隔离级别，支持多版本读。</li><li>行级锁定（更新时一般是锁定当前行）：通过索引实现，全表扫描仍然会是表锁，注意间隙锁的影响。</li><li>读写阻塞与事务隔离级别相关。</li><li>具有非常搞笑的缓存特性：能缓存索引，也能缓存数据。</li><li>整个表和主键以Cluster方式存储，组成一颗平衡树。</li><li>所有Secondary Index都会保存主键信息。</li><li>支持分区，表空间，类似oracle数据库</li><li>支持外键约束，5.5前不支持全文索引</li><li>和MyISAM引擎比，InnoDB对硬件资源要求更高</li></ol><blockquote><p>面试必问</p><p>innodb特点：面试必答项：</p><ol><li>row-level locking</li><li>full-text search indexs</li><li>data caches</li><li>index caches</li><li>transactions</li><li>占用资源多</li><li>读写阻塞与事务隔离级别相关</li><li>外键</li></ol></blockquote><h3 id=innodb引擎使用的生产业务场景>innodb引擎使用的生产业务场景<a hidden class=anchor aria-hidden=true href=#innodb引擎使用的生产业务场景>#</a></h3><ol><li>需要事务支持的业务（具有较好的事务特性）。</li><li>行级锁定对高并发有很好的适应能力，但需要确保查询是通过索引完成。</li><li>数据读写及更新都较为频繁的场景，如:BBS SNS 微博，微信等。</li><li>数据一致性要求较高的业务，例如：充值转账，银行卡转账。</li><li>硬件设备内存较大，可以利用InnoDB较好的缓存能力来提高内存利用率，尽可能减少磁盘IO</li></ol><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>conf</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><pre tabindex=0><code class=language-conf data-lang=conf>innodb_additional_mem_pool_size = 4M
innodb_buffer_pool_size = 32M
innodb_data_file_path = ibdata1:128M:autoextend
innodb_file_io_threads = 4
innodb_thread_concurrency = 8
innodb_flush_log_at_trx_commit = 2
innodb_log_buffer_size = 2M
innodb_log_file_size = 4M
innodb_log_files_in_group = 3
innodb_max_dirty_pages_pct = 90
innodb_lock_wait_timeout = 120
innodb_file_per_table = 0</code></pre></div></div><p>共享表空间对应物理数据文件</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ll test/
</span></span><span class=line><span class=cl>ibdata1
</span></span><span class=line><span class=cl>ib_logfile0</span></span></code></pre></td></tr></table></div></div></div></div><p>独立表空间对应物理数据文件</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>innodb_file_per_table
</span></span><span class=line><span class=cl><span class=nv>innodb_data_home_dir</span><span class=o>=</span>xxx</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=innodb引擎调优精要>innodb引擎调优精要<a hidden class=anchor aria-hidden=true href=#innodb引擎调优精要>#</a></h3><ol><li><p>主键尽可能小，避免给Secondary index带来过大的空间负担</p></li><li><p>建立有效索引避免全表扫描，因为会使用表锁。</p></li><li><p>尽可能缓存所有的索引和数据，提高相应速度，减少磁盘IO消耗</p></li><li><p>在大批量小插入的时候，尽量自己控制事务而不要使用autocommit自动提交。有开关可以控制提交方式；</p></li><li><p>合理设置innodb_flush_log_at_trx_commit参数值，不要过度追求安全性。</p><p>如果innodb_flush_log_at_trx_commit的值为0，log buffer每秒就会被刷写日志文件到磁盘，提交事务时候不做任何操作。</p></li><li><p>避免主键更新。（字段的起名长短都会影响性能）。</p></li></ol><h2 id=mysql引擎特别说明>MySQL引擎特别说明<a hidden class=anchor aria-hidden=true href=#mysql引擎特别说明>#</a></h2><table><thead><tr><th>Feature</th><th>MyISAM</th><th>Memory</th><th>InnoDB</th><th>Archive</th><th>NDB</th></tr></thead><tbody><tr><td>Storage limits</td><td>256TB</td><td>RAM</td><td>64TB</td><td>None</td><td>384EB</td></tr><tr><td>Transactions</td><td>No</td><td>No</td><td>Yes</td><td>No</td><td>Yes</td></tr><tr><td>Locking granularity</td><td>Table</td><td>Table</td><td>Row</td><td>Row</td><td>Row</td></tr><tr><td>MVCC</td><td>No</td><td>No</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>Geospatial data type support</td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Geospatial indexing support</td><td>Yes</td><td>No</td><td>Yes[a]</td><td>No</td><td>No</td></tr><tr><td>B-tree indexes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>T-tree indexes</td><td>No</td><td>No</td><td>No</td><td>No</td><td>Yes</td></tr><tr><td>Hash indexes</td><td>No</td><td>Yes</td><td>No[b]</td><td>No</td><td>Yes</td></tr><tr><td>Full-text search indexes</td><td>Yes</td><td>No</td><td>Yes[c]</td><td>No</td><td>No</td></tr><tr><td>Clustered indexes</td><td>No</td><td>No</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>Data caches</td><td>No</td><td>N/A</td><td>Yes</td><td>No</td><td>Yes</td></tr><tr><td>Index caches</td><td>Yes</td><td>N/A</td><td>Yes</td><td>No</td><td>Yes</td></tr><tr><td>Compressed data</td><td>Yes[d]</td><td>No</td><td>Yes[e]</td><td>Yes</td><td>No</td></tr><tr><td>Encrypted data[f]</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Cluster database support</td><td>No</td><td>No</td><td>No</td><td>No</td><td>Yes</td></tr><tr><td>Replication support[g]</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Foreign key support</td><td>No</td><td>No</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>Backup / point-in-time recovery[h]</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Query cache support</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Update statistics for data dictionary</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><ul><li>[a] InnoDB support for geospatial indexing is available in MySQL 5.7.5 and higher.</li><li>[b] InnoDB utilizes hash indexes internally for its Adaptive Hash Index feature.</li><li>[c] InnoDB support for FULLTEXT indexes is available in MySQL 5.6.4 and higher.</li><li>[d] Compressed MyISAM tables are supported only when using the compressed row format. Tables using the compressed row format with MyISAM are read only.</li><li>[e] Compressed InnoDB tables require the InnoDB Barracuda file format.</li><li>[f] Implemented in the server (via encryption functions). Data-at-rest tablespace encryption is available in MySQL 5.7 and higher.</li><li>[g] Implemented in the server, rather than in the storage engine.</li><li>[h] Implemented in the server, rather than in the storage engine.</li></ul><p>参考手册：https://dev.mysql.com/doc/refman/5.5/en/storage-engines.html</p><p>以上是myisam innodb和NDBCluster三个存储引擎是目前互联网公司应用比较多的存储引擎，特别是前两者，其他如 memory merge csv archive等存储引擎的使用场景都相对较少，初学的同学可以暂时忽略。更多可参考MySQL官方文档。</p><h2 id=如何确定mysql服务器有那些引擎可用>如何确定MySQL服务器有那些引擎可用？<a hidden class=anchor aria-hidden=true href=#如何确定mysql服务器有那些引擎可用>#</a></h2><p>在MySQL中使用显示引擎的命令得到一个可用引擎的列表</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>show engines<span class=se>\G</span>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>*************************** 5. row ***************************
</span></span><span class=line><span class=cl>      Engine: MyISAM
</span></span><span class=line><span class=cl>     Support: YES
</span></span><span class=line><span class=cl>     Comment: MyISAM storage engine
</span></span><span class=line><span class=cl>Transactions: NO
</span></span><span class=line><span class=cl>          XA: NO
</span></span><span class=line><span class=cl>  Savepoints: NO
</span></span><span class=line><span class=cl>*************************** 6. row ***************************
</span></span><span class=line><span class=cl>      Engine: InnoDB
</span></span><span class=line><span class=cl>     Support: DEFAULT
</span></span><span class=line><span class=cl>     Comment: Percona-XtraDB, Supports transactions, row-level locking, and foreign keys
</span></span><span class=line><span class=cl>Transactions: YES
</span></span><span class=line><span class=cl>          XA: YES
</span></span><span class=line><span class=cl>  Savepoints: YES
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl><span class=m>10</span> rows in <span class=nb>set</span> <span class=o>(</span>0.01 sec<span class=o>)</span></span></span></code></pre></td></tr></table></div></div></div></div><h2 id=生产场景中批量更改mysql引擎>生产场景中批量更改MySQL引擎<a hidden class=anchor aria-hidden=true href=#生产场景中批量更改mysql引擎>#</a></h2><p>一般来说这样的需求不多见，但偶尔也会有，在这里我们推荐使用sed对备份内容进行引擎转换的方式，当然，不要忘记修改my.cnf使之支持并能高效的使用对应的引擎</p><p><font color=#0215cd size=3><strong>方法1：MySQL命令语句修改</strong></font></p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>alter table <span class=nb>test</span> <span class=nv>engine</span><span class=o>=</span>innodb<span class=p>;</span></span></span></code></pre></td></tr></table></div></div></div></div><p><font color=#0215cd size=3><strong>方法2：使用sed对备份内容进行引擎转换</strong></font></p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 此方法折腾数据不推荐使用</span>
</span></span><span class=line><span class=cl><span class=c1># 主从复制丛库换引擎，正式数据换不要用</span>
</span></span><span class=line><span class=cl>sed -e <span class=s1>&#39;s#MyISAM#InnoDB#g&#39;</span> b.sql&gt;b1.sql</span></span></code></pre></td></tr></table></div></div></div></div><p><font color=#0215cd size=3><strong>方法3：mysql_convert_table_format命令修改</strong></font></p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mysql_convert_table_format --host<span class=o>=</span><span class=nv>$HOST</span> --user<span class=o>=</span><span class=nv>$USER</span> --passsword<span class=o>=</span><span class=nv>$PASS</span> --socket<span class=o>=</span><span class=nv>$SOCKET</span> --type<span class=o>=</span><span class=nv>$Engine</span> <span class=nv>$DB</span> <span class=nv>$TN</span></span></span></code></pre></td></tr></table></div></div></div></div><p>建表语句加上指定引擎：</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>create table test<span class=o>(</span>
</span></span><span class=line><span class=cl>id int not null
</span></span><span class=line><span class=cl><span class=o>)</span> <span class=nv>engine</span><span class=o>=</span>innodb default <span class=nv>charset</span><span class=o>=</span>utf8<span class=p>;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>混合引擎和单独innodb引擎配置差别？</p><h2 id=有关mysql引擎常见企业面试题>有关MySQL引擎常见企业面试题<a hidden class=anchor aria-hidden=true href=#有关mysql引擎常见企业面试题>#</a></h2><ol><li>MySQL有那些存储引擎，各自有什么特点和区别？</li><li>生产环境中如何选用MySQL的引擎</li></ol><p>​ 在一般的既有读又有写的业务中，建议使用innodb引擎，一句话尽可能多的使用innodb引擎。</p><p>​ 纯读 纯写可用myisam。例如系统的MySQL库。</p><ol start=3><li><p>不同引擎如何备份？混合引擎如何备份。</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># myisam</span>
</span></span><span class=line><span class=cl>mysqldump -uroot -p111 -S/data/3306/mysql.sock <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-A <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-x <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-B <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-F <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	--master-data<span class=o>=</span>2<span class=p>|</span>gzip &gt;back.sql
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># innodb</span>
</span></span><span class=line><span class=cl>mysqldump -uroot -p111 -S/data/3306/mysql.sock <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-A <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-x <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-B <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	-F <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	--master-data<span class=o>=</span><span class=m>2</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	--single-transaction<span class=p>|</span>gzip &gt;back.sql </span></span></code></pre></td></tr></table></div></div></div></div></li></ol></div><div class=pe-copyright><hr><blockquote><p>本文为原创内容，版权归作者所有。如需转载，请在文章中声明本文标题及链接。</p><p>文章标题：ch08 - MySQL存储引擎</p><p>文章链接：<a href=https://www.oomkill.com/2017/05/ch8-mysql-engine/ target=_blank>https://www.oomkill.com/2017/05/ch8-mysql-engine/</a></p><p>许可协议：<a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></p></blockquote></div><div class=comments-separator></div><h3 class=relatedContentTitle>相关阅读</h3><ul class=relatedContent><li><a href=/2017/05/ch7-mysql-non-interact/><span>ch07 - 实现和MySQL非交互式对话</span></a></li><li><a href=/2017/05/ch04-mysql-log/><span>ch04 - MySQL数据库服务日志类型</span></a></li><li><a href=/2017/05/ch6-mysql-replication/><span>ch06 - MySQL主从复制</span></a></li><li><a href=/2017/05/ch2-mysql-security/><span>ch02 - MySQL安全相关配置</span></a></li><li><a href=/2017/05/ch5-mysql-charset/><span>ch05 - MySQL字符集相关配置</span></a></li></ul><div class=comments-separator></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.oomkill.com/tags/databases/>Databases</a></li></ul><nav class=paginav><a class=prev href=https://www.oomkill.com/2017/11/haproxy/><span class=title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></polyline></svg>&nbsp;</span>
<span>详解haproxy</span>
</a><a class=next href=https://www.oomkill.com/2017/05/ch7-mysql-non-interact/><span class=title></span>
<span>ch07 - 实现和MySQL非交互式对话&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span></a></nav></footer><div class=pe-comments-decoration><p class=pe-comments-title></p><p class=pe-comments-subtitle></p></div><div id=pe-comments></div><script src=/js/pe-go-comment.min.86a214102576ba5f9b7bdc29eed8d58dd56e34aef80b3c65c73ea9cc88443696.js integrity="sha256-hqIUECV2ul+be9wp7tjVjdVuNK74Czxlxz6pzIhENpY="></script><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"cylonchau/blogs","data-repo-id":"R_kgDOIRlNSQ","data-category":"Announcements","data-category-id":"DIC_kwDOIRlNSc4CXy1U","data-mapping":"pathname","data-term":"posts/ch8 mysql engine","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"zh-TW","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector("#pe-comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.oomkill.com/>Cylon's Collection</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> on
<a href=https://pages.github.com/ rel=noopener target=_blank>GitHub Pages</a> & Theme
        <a href=https://github.com/tofuwine/PaperMod-PE rel=noopener target=_blank>PaperMod-PE</a></span></footer><div class=pe-right-sidebar><a href=javascript:void(0); id=theme-toggle-float class=pe-float-btn><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a href=#top class=pe-float-btn id=top-link><span id=pe-read-progress></span></a></div><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>